<html lang="en" style="height: auto; min-height: 100%;">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Save Data Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'rajdhani': ['Rajdhani', 'sans-serif']
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: 'Rajdhani', sans-serif;
      background: linear-gradient(135deg, #0D0F12 0%, #1a1d24 100%);
    }

    .glow-border {
      box-shadow: 0 0 20px rgba(0, 191, 255, 0.3);
    }

    .glow-border-active {
      box-shadow: 0 0 30px rgba(0, 191, 255, 0.6), 0 0 60px rgba(0, 191, 255, 0.3);
    }

    .card-hover {
      transition: all 0.3s ease;
    }

    .card-hover:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 30px rgba(0, 191, 255, 0.5);
    }

    .btn-glow:hover {
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.6);
      transform: translateY(-2px);
    }

    .tier-btn {
      transition: all 0.2s ease;
    }

    .tier-btn:hover {
      transform: scale(1.1);
    }

    .tier-active {
      background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);
      box-shadow: 0 0 20px rgba(0, 191, 255, 0.6);
    }

    .modal-overlay {
      backdrop-filter: blur(8px);
    }

    .modal-enter {
      animation: modalEnter 0.3s ease-out;
    }

    @keyframes modalEnter {
      from {
        opacity: 0;
        transform: scale(0.9);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .card-type-btn {
      transition: all 0.3s ease;
    }

    .card-type-btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 30px rgba(0, 191, 255, 0.6);
    }

    .action-btn-inactive {
      background: rgba(75, 85, 99, 0.2) !important;
      border-color: rgba(75, 85, 99, 0.5) !important;
      color: rgba(156, 163, 175, 0.8) !important;
    }

    .action-btn-inactive:hover {
      background: rgba(75, 85, 99, 0.3) !important;
    }

    .card-duplicate-animation {
      animation: cardDuplicate 0.5s ease-out;
    }

    @keyframes cardDuplicate {
      from {
        opacity: 0;
        transform: scale(0.8) translateX(-20px);
      }

      to {
        opacity: 1;
        transform: scale(1) translateX(0);
      }
    }

    select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2300bfff'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 1.5em 1.5em;
      padding-right: 2.5rem;
    }

    .sticky-header {
      /* position: sticky; */
      /* top: 0; */
      /* z-index: 40; */
      transition: all 0.3s ease;
    }

    .sticky-header.scrolled {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }
  </style>
  <style>
    *,
    ::before,
    ::after {
      --tw-border-spacing-x: 0;
      --tw-border-spacing-y: 0;
      --tw-translate-x: 0;
      --tw-translate-y: 0;
      --tw-rotate: 0;
      --tw-skew-x: 0;
      --tw-skew-y: 0;
      --tw-scale-x: 1;
      --tw-scale-y: 1;
      --tw-pan-x: ;
      --tw-pan-y: ;
      --tw-pinch-zoom: ;
      --tw-scroll-snap-strictness: proximity;
      --tw-gradient-from-position: ;
      --tw-gradient-via-position: ;
      --tw-gradient-to-position: ;
      --tw-ordinal: ;
      --tw-slashed-zero: ;
      --tw-numeric-figure: ;
      --tw-numeric-spacing: ;
      --tw-numeric-fraction: ;
      --tw-ring-inset: ;
      --tw-ring-offset-width: 0px;
      --tw-ring-offset-color: #fff;
      --tw-ring-color: rgb(59 130 246 / 0.5);
      --tw-ring-offset-shadow: 0 0 #0000;
      --tw-ring-shadow: 0 0 #0000;
      --tw-shadow: 0 0 #0000;
      --tw-shadow-colored: 0 0 #0000;
      --tw-blur: ;
      --tw-brightness: ;
      --tw-contrast: ;
      --tw-grayscale: ;
      --tw-hue-rotate: ;
      --tw-invert: ;
      --tw-saturate: ;
      --tw-sepia: ;
      --tw-drop-shadow: ;
      --tw-backdrop-blur: ;
      --tw-backdrop-brightness: ;
      --tw-backdrop-contrast: ;
      --tw-backdrop-grayscale: ;
      --tw-backdrop-hue-rotate: ;
      --tw-backdrop-invert: ;
      --tw-backdrop-opacity: ;
      --tw-backdrop-saturate: ;
      --tw-backdrop-sepia: ;
      --tw-contain-size: ;
      --tw-contain-layout: ;
      --tw-contain-paint: ;
      --tw-contain-style:
    }

    ::backdrop {
      --tw-border-spacing-x: 0;
      --tw-border-spacing-y: 0;
      --tw-translate-x: 0;
      --tw-translate-y: 0;
      --tw-rotate: 0;
      --tw-skew-x: 0;
      --tw-skew-y: 0;
      --tw-scale-x: 1;
      --tw-scale-y: 1;
      --tw-pan-x: ;
      --tw-pan-y: ;
      --tw-pinch-zoom: ;
      --tw-scroll-snap-strictness: proximity;
      --tw-gradient-from-position: ;
      --tw-gradient-via-position: ;
      --tw-gradient-to-position: ;
      --tw-ordinal: ;
      --tw-slashed-zero: ;
      --tw-numeric-figure: ;
      --tw-numeric-spacing: ;
      --tw-numeric-fraction: ;
      --tw-ring-inset: ;
      --tw-ring-offset-width: 0px;
      --tw-ring-offset-color: #fff;
      --tw-ring-color: rgb(59 130 246 / 0.5);
      --tw-ring-offset-shadow: 0 0 #0000;
      --tw-ring-shadow: 0 0 #0000;
      --tw-shadow: 0 0 #0000;
      --tw-shadow-colored: 0 0 #0000;
      --tw-blur: ;
      --tw-brightness: ;
      --tw-contrast: ;
      --tw-grayscale: ;
      --tw-hue-rotate: ;
      --tw-invert: ;
      --tw-saturate: ;
      --tw-sepia: ;
      --tw-drop-shadow: ;
      --tw-backdrop-blur: ;
      --tw-backdrop-brightness: ;
      --tw-backdrop-contrast: ;
      --tw-backdrop-grayscale: ;
      --tw-backdrop-hue-rotate: ;
      --tw-backdrop-invert: ;
      --tw-backdrop-opacity: ;
      --tw-backdrop-saturate: ;
      --tw-backdrop-sepia: ;
      --tw-contain-size: ;
      --tw-contain-layout: ;
      --tw-contain-paint: ;
      --tw-contain-style:
    }

    /* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */
    *,
    ::after,
    ::before {
      box-sizing: border-box;
      border-width: 0;
      border-style: solid;
      border-color: #e5e7eb
    }

    ::after,
    ::before {
      --tw-content: ''
    }

    :host,
    html {
      line-height: 1.5;
      -webkit-text-size-adjust: 100%;
      -moz-tab-size: 4;
      tab-size: 4;
      font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
      font-feature-settings: normal;
      font-variation-settings: normal;
      -webkit-tap-highlight-color: transparent
    }

    body {
      margin: 0;
      line-height: inherit
    }

    hr {
      height: 0;
      color: inherit;
      border-top-width: 1px
    }

    abbr:where([title]) {
      -webkit-text-decoration: underline dotted;
      text-decoration: underline dotted
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-size: inherit;
      font-weight: inherit
    }

    a {
      color: inherit;
      text-decoration: inherit
    }

    b,
    strong {
      font-weight: bolder
    }

    code,
    kbd,
    pre,
    samp {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-feature-settings: normal;
      font-variation-settings: normal;
      font-size: 1em
    }

    small {
      font-size: 80%
    }

    sub,
    sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline
    }

    sub {
      bottom: -.25em
    }

    sup {
      top: -.5em
    }

    table {
      text-indent: 0;
      border-color: inherit;
      border-collapse: collapse
    }

    button,
    input,
    optgroup,
    select,
    textarea {
      font-family: inherit;
      font-feature-settings: inherit;
      font-variation-settings: inherit;
      font-size: 100%;
      font-weight: inherit;
      line-height: inherit;
      letter-spacing: inherit;
      color: inherit;
      margin: 0;
      padding: 0
    }

    button,
    select {
      text-transform: none
    }

    button,
    input:where([type=button]),
    input:where([type=reset]),
    input:where([type=submit]) {
      -webkit-appearance: button;
      background-color: transparent;
      background-image: none
    }

    :-moz-focusring {
      outline: auto
    }

    :-moz-ui-invalid {
      box-shadow: none
    }

    progress {
      vertical-align: baseline
    }

    ::-webkit-inner-spin-button,
    ::-webkit-outer-spin-button {
      height: auto
    }

    [type=search] {
      -webkit-appearance: textfield;
      outline-offset: -2px
    }

    ::-webkit-search-decoration {
      -webkit-appearance: none
    }

    ::-webkit-file-upload-button {
      -webkit-appearance: button;
      font: inherit
    }

    summary {
      display: list-item
    }

    blockquote,
    dd,
    dl,
    figure,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    hr,
    p,
    pre {
      margin: 0
    }

    fieldset {
      margin: 0;
      padding: 0
    }

    legend {
      padding: 0
    }

    menu,
    ol,
    ul {
      list-style: none;
      margin: 0;
      padding: 0
    }

    dialog {
      padding: 0
    }

    textarea {
      resize: vertical
    }

    input::placeholder,
    textarea::placeholder {
      opacity: 1;
      color: #9ca3af
    }

    [role=button],
    button {
      cursor: pointer
    }

    :disabled {
      cursor: default
    }

    audio,
    canvas,
    embed,
    iframe,
    img,
    object,
    svg,
    video {
      display: block;
      vertical-align: middle
    }

    img,
    video {
      max-width: 100%;
      height: auto
    }

    [hidden]:where(:not([hidden=until-found])) {
      display: none
    }

    .fixed {
      position: fixed
    }

    .inset-0 {
      inset: 0px
    }

    .z-50 {
      z-index: 50
    }

    .mx-auto {
      margin-left: auto;
      margin-right: auto
    }

    .mb-3 {
      margin-bottom: 0.75rem
    }

    .mb-4 {
      margin-bottom: 1rem
    }

    .mb-6 {
      margin-bottom: 1.5rem
    }

    .mr-2 {
      margin-right: 0.5rem
    }

    .mr-3 {
      margin-right: 0.75rem
    }

    .mt-1 {
      margin-top: 0.25rem
    }

    .mt-2 {
      margin-top: 0.5rem
    }

    .flex {
      display: flex
    }

    .grid {
      display: grid
    }

    .hidden {
      display: none
    }

    .h-10 {
      height: 2.5rem
    }

    .h-12 {
      height: 3rem
    }

    .h-20 {
      height: 5rem
    }

    .h-48 {
      height: 12rem
    }

    .h-full {
      height: 100%
    }

    .w-10 {
      width: 2.5rem
    }

    .w-20 {
      width: 5rem
    }

    .w-80 {
      width: 20rem
    }

    .w-full {
      width: 100%
    }

    .max-w-2xl {
      max-width: 42rem
    }

    .flex-1 {
      flex: 1 1 0%
    }

    .cursor-pointer {
      cursor: pointer
    }

    .appearance-none {
      -webkit-appearance: none;
      appearance: none
    }

    .grid-cols-1 {
      grid-template-columns: repeat(1, minmax(0, 1fr))
    }

    .grid-cols-5 {
      grid-template-columns: repeat(5, minmax(0, 1fr))
    }

    .flex-col {
      flex-direction: column
    }

    .items-center {
      align-items: center
    }

    .justify-center {
      justify-content: center
    }

    .justify-between {
      justify-content: space-between
    }

    .gap-2 {
      gap: 0.5rem
    }

    .gap-3 {
      gap: 0.75rem
    }

    .gap-4 {
      gap: 1rem
    }

    .space-y-2> :not([hidden])~ :not([hidden]) {
      --tw-space-y-reverse: 0;
      margin-top: calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));
      margin-bottom: calc(0.5rem * var(--tw-space-y-reverse))
    }

    .overflow-hidden {
      overflow: hidden
    }

    .whitespace-nowrap {
      white-space: nowrap
    }

    .rounded-2xl {
      border-radius: 1rem
    }

    .rounded-3xl {
      border-radius: 1.5rem
    }

    .rounded-full {
      border-radius: 9999px
    }

    .rounded-lg {
      border-radius: 0.5rem
    }

    .border {
      border-width: 1px
    }

    .border-2 {
      border-width: 2px
    }

    .border-b {
      border-bottom-width: 1px
    }

    .border-r {
      border-right-width: 1px
    }

    .border-t {
      border-top-width: 1px
    }

    .border-dashed {
      border-style: dashed
    }

    .border-cyan-500\/20 {
      border-color: rgb(6 182 212 / 0.2)
    }

    .border-cyan-500\/30 {
      border-color: rgb(6 182 212 / 0.3)
    }

    .border-gray-500\/50 {
      border-color: rgb(107 114 128 / 0.5)
    }

    .border-purple-500\/50 {
      border-color: rgb(168 85 247 / 0.5)
    }

    .border-red-500\/50 {
      border-color: rgb(239 68 68 / 0.5)
    }

    .border-yellow-500\/50 {
      border-color: rgb(234 179 8 / 0.5)
    }

    .bg-black\/80 {
      background-color: rgb(0 0 0 / 0.8)
    }

    .bg-cyan-500\/10 {
      background-color: rgb(6 182 212 / 0.1)
    }

    .bg-gray-500\/20 {
      background-color: rgb(107 114 128 / 0.2)
    }

    .bg-gray-800\/50 {
      background-color: rgb(31 41 55 / 0.5)
    }

    .bg-gray-800\/80 {
      background-color: rgb(31 41 55 / 0.8)
    }

    .bg-purple-500\/20 {
      background-color: rgb(168 85 247 / 0.2)
    }

    .bg-red-500\/20 {
      background-color: rgb(239 68 68 / 0.2)
    }

    .bg-red-600\/20 {
      background-color: rgb(220 38 38 / 0.2)
    }

    .bg-transparent {
      background-color: transparent
    }

    .bg-yellow-500\/20 {
      background-color: rgb(234 179 8 / 0.2)
    }

    .bg-gradient-to-b {
      background-image: linear-gradient(to bottom, var(--tw-gradient-stops))
    }

    .bg-gradient-to-br {
      background-image: linear-gradient(to bottom right, var(--tw-gradient-stops))
    }

    .bg-gradient-to-r {
      background-image: linear-gradient(to right, var(--tw-gradient-stops))
    }

    .from-cyan-600\/20 {
      --tw-gradient-from: rgb(8 145 178 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(8 145 178 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-gray-600\/20 {
      --tw-gradient-from: rgb(75 85 99 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(75 85 99 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-gray-800 {
      --tw-gradient-from: #1f2937 var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(31 41 55 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-gray-900 {
      --tw-gradient-from: #111827 var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(17 24 39 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-green-600\/20 {
      --tw-gradient-from: rgb(22 163 74 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(22 163 74 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-purple-600\/20 {
      --tw-gradient-from: rgb(147 51 234 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(147 51 234 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-red-600\/20 {
      --tw-gradient-from: rgb(220 38 38 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(220 38 38 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .from-yellow-600\/20 {
      --tw-gradient-from: rgb(202 138 4 / 0.2) var(--tw-gradient-from-position);
      --tw-gradient-to: rgb(202 138 4 / 0) var(--tw-gradient-to-position);
      --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)
    }

    .to-blue-600\/20 {
      --tw-gradient-to: rgb(37 99 235 / 0.2) var(--tw-gradient-to-position)
    }

    .to-gray-800\/20 {
      --tw-gradient-to: rgb(31 41 55 / 0.2) var(--tw-gradient-to-position)
    }

    .to-gray-900 {
      --tw-gradient-to: #111827 var(--tw-gradient-to-position)
    }

    .to-gray-950 {
      --tw-gradient-to: #030712 var(--tw-gradient-to-position)
    }

    .to-orange-600\/20 {
      --tw-gradient-to: rgb(234 88 12 / 0.2) var(--tw-gradient-to-position)
    }

    .to-orange-800\/20 {
      --tw-gradient-to: rgb(154 52 18 / 0.2) var(--tw-gradient-to-position)
    }

    .to-pink-600\/20 {
      --tw-gradient-to: rgb(219 39 119 / 0.2) var(--tw-gradient-to-position)
    }

    .to-purple-800\/20 {
      --tw-gradient-to: rgb(107 33 168 / 0.2) var(--tw-gradient-to-position)
    }

    .to-red-800\/20 {
      --tw-gradient-to: rgb(153 27 27 / 0.2) var(--tw-gradient-to-position)
    }

    .to-teal-600\/20 {
      --tw-gradient-to: rgb(13 148 136 / 0.2) var(--tw-gradient-to-position)
    }

    .object-cover {
      object-fit: cover
    }

    .p-4 {
      padding: 1rem
    }

    .p-5 {
      padding: 1.25rem
    }

    .p-6 {
      padding: 1.5rem
    }

    .p-8 {
      padding: 2rem
    }

    .px-3 {
      padding-left: 0.75rem;
      padding-right: 0.75rem
    }

    .px-4 {
      padding-left: 1rem;
      padding-right: 1rem
    }

    .px-6 {
      padding-left: 1.5rem;
      padding-right: 1.5rem
    }

    .py-2 {
      padding-top: 0.5rem;
      padding-bottom: 0.5rem
    }

    .py-2\.5 {
      padding-top: 0.625rem;
      padding-bottom: 0.625rem
    }

    .py-3 {
      padding-top: 0.75rem;
      padding-bottom: 0.75rem
    }

    .text-left {
      text-align: left
    }

    .text-center {
      text-align: center
    }

    .text-2xl {
      font-size: 1.5rem;
      line-height: 2rem
    }

    .text-3xl {
      font-size: 1.875rem;
      line-height: 2.25rem
    }

    .text-4xl {
      font-size: 2.25rem;
      line-height: 2.5rem
    }

    .text-lg {
      font-size: 1.125rem;
      line-height: 1.75rem
    }

    .text-sm {
      font-size: 0.875rem;
      line-height: 1.25rem
    }

    .text-xl {
      font-size: 1.25rem;
      line-height: 1.75rem
    }

    .text-xs {
      font-size: 0.75rem;
      line-height: 1rem
    }

    .font-bold {
      font-weight: 700
    }

    .font-semibold {
      font-weight: 600
    }

    .uppercase {
      text-transform: uppercase
    }

    .tracking-wide {
      letter-spacing: 0.025em
    }

    .tracking-wider {
      letter-spacing: 0.05em
    }

    .text-gray-100 {
      --tw-text-opacity: 1;
      color: rgb(243 244 246 / var(--tw-text-opacity, 1))
    }

    .text-cyan-300 {
      --tw-text-opacity: 1;
      color: rgb(103 232 249 / var(--tw-text-opacity, 1))
    }

    .text-cyan-400 {
      --tw-text-opacity: 1;
      color: rgb(34 211 238 / var(--tw-text-opacity, 1))
    }

    .text-gray-300 {
      --tw-text-opacity: 1;
      color: rgb(209 213 219 / var(--tw-text-opacity, 1))
    }

    .text-gray-400 {
      --tw-text-opacity: 1;
      color: rgb(156 163 175 / var(--tw-text-opacity, 1))
    }

    .text-gray-500 {
      --tw-text-opacity: 1;
      color: rgb(107 114 128 / var(--tw-text-opacity, 1))
    }

    .text-purple-300 {
      --tw-text-opacity: 1;
      color: rgb(216 180 254 / var(--tw-text-opacity, 1))
    }

    .text-purple-400 {
      --tw-text-opacity: 1;
      color: rgb(192 132 252 / var(--tw-text-opacity, 1))
    }

    .text-red-300 {
      --tw-text-opacity: 1;
      color: rgb(252 165 165 / var(--tw-text-opacity, 1))
    }

    .text-red-400 {
      --tw-text-opacity: 1;
      color: rgb(248 113 113 / var(--tw-text-opacity, 1))
    }

    .text-white {
      --tw-text-opacity: 1;
      color: rgb(255 255 255 / var(--tw-text-opacity, 1))
    }

    .text-yellow-300 {
      --tw-text-opacity: 1;
      color: rgb(253 224 71 / var(--tw-text-opacity, 1))
    }

    .text-yellow-400 {
      --tw-text-opacity: 1;
      color: rgb(250 204 21 / var(--tw-text-opacity, 1))
    }

    .opacity-60 {
      opacity: 0.6
    }

    .transition-all {
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms
    }

    .transition-colors {
      transition-property: color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;
      transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
      transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms
    }

    .duration-300 {
      transition-duration: 300ms
    }

    .hover\:border-cyan-500\/60:hover {
      border-color: rgb(6 182 212 / 0.6)
    }

    .hover\:border-gray-400:hover {
      --tw-border-opacity: 1;
      border-color: rgb(156 163 175 / var(--tw-border-opacity, 1))
    }

    .hover\:border-purple-400:hover {
      --tw-border-opacity: 1;
      border-color: rgb(192 132 252 / var(--tw-border-opacity, 1))
    }

    .hover\:border-red-400:hover {
      --tw-border-opacity: 1;
      border-color: rgb(248 113 113 / var(--tw-border-opacity, 1))
    }

    .hover\:border-yellow-400:hover {
      --tw-border-opacity: 1;
      border-color: rgb(250 204 21 / var(--tw-border-opacity, 1))
    }

    .hover\:bg-cyan-500\/5:hover {
      background-color: rgb(6 182 212 / 0.05)
    }

    .hover\:bg-gray-700:hover {
      --tw-bg-opacity: 1;
      background-color: rgb(55 65 81 / var(--tw-bg-opacity, 1))
    }

    .hover\:bg-red-600\/40:hover {
      background-color: rgb(220 38 38 / 0.4)
    }

    .hover\:text-cyan-400:hover {
      --tw-text-opacity: 1;
      color: rgb(34 211 238 / var(--tw-text-opacity, 1))
    }

    .hover\:shadow-lg:hover {
      --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
      --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);
      box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)
    }

    .hover\:shadow-red-500\/30:hover {
      --tw-shadow-color: rgb(239 68 68 / 0.3);
      --tw-shadow: var(--tw-shadow-colored)
    }

    .focus\:border-cyan-500:focus {
      --tw-border-opacity: 1;
      border-color: rgb(6 182 212 / var(--tw-border-opacity, 1))
    }

    .focus\:outline-none:focus {
      outline: 2px solid transparent;
      outline-offset: 2px
    }

    @media (min-width: 640px) {
      .sm\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr))
      }
    }

    @media (min-width: 768px) {
      .md\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr))
      }
    }

    @media (min-width: 1024px) {
      .lg\:mb-4 {
        margin-bottom: 1rem
      }

      .lg\:mb-6 {
        margin-bottom: 1.5rem
      }

      .lg\:mb-8 {
        margin-bottom: 2rem
      }

      .lg\:mr-4 {
        margin-right: 1rem
      }

      .lg\:block {
        display: block
      }

      .lg\:flex {
        display: flex
      }

      .lg\:hidden {
        display: none
      }

      .lg\:h-12 {
        height: 3rem
      }

      .lg\:w-12 {
        width: 3rem
      }

      .lg\:grid-cols-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr))
      }

      .lg\:flex-row {
        flex-direction: row
      }

      .lg\:gap-4 {
        gap: 1rem
      }

      .lg\:gap-6 {
        gap: 1.5rem
      }

      .lg\:p-6 {
        padding: 1.5rem
      }

      .lg\:p-8 {
        padding: 2rem
      }

      .lg\:text-2xl {
        font-size: 1.5rem;
        line-height: 2rem
      }

      .lg\:text-3xl {
        font-size: 1.875rem;
        line-height: 2.25rem
      }

      .lg\:text-base {
        font-size: 1rem;
        line-height: 1.5rem
      }

      .lg\:text-sm {
        font-size: 0.875rem;
        line-height: 1.25rem
      }
    }

    .character-select-card {
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .character-select-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 0 30px rgba(0, 191, 255, 0.5);
    }

    .character-selected {
      border-color: rgba(0, 191, 255, 0.8) !important;
      box-shadow: 0 0 30px rgba(0, 191, 255, 0.6) !important;
    }

    .character-selected::after {
      content: 'âœ“';
      position: absolute;
      top: 10px;
      right: 10px;
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #00bfff 0%, #0080ff 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: bold;
      color: white;
      box-shadow: 0 0 15px rgba(0, 191, 255, 0.8);
    }

    #mainContent {
      display: none;
    }

    .selection-dot {
      width: 64px;
      height: 64px;
      border-radius: 8px;
      border: 3px dashed rgba(0, 191, 255, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      background: rgba(0, 191, 255, 0.05);
    }

    .selection-dot.filled {
      border: 3px solid rgba(0, 191, 255, 0.8);
      box-shadow: 0 0 20px rgba(0, 191, 255, 0.5);
      background: rgba(0, 191, 255, 0.1);
    }

    .selection-dot img {
      width: 100%;
      height: 100%;
      border-radius: 6px;
      object-fit: cover;
    }

    .dot-fill-animation {
      animation: dotFill 0.4s ease-out;
    }

    @keyframes dotFill {
      0% {
        transform: scale(0.5);
        opacity: 0;
      }

      50% {
        transform: scale(1.2);
      }

      100% {
        transform: scale(1);
        opacity: 1;
      }
    }
  </style>
</head>

<body style="height: auto; min-height: 100%;" class="text-gray-100">
  <div id="characterSelectionModal"
    class="fixed inset-0 bg-black/90 modal-overlay flex items-center justify-center z-50 p-4">
    <div
      class="bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-cyan-500/30 p-6 lg:p-8 max-w-6xl w-full modal-enter glow-border-active max-h-[90vh] flex flex-col">
      <div class="text-center mb-6">
        <h1 class="text-3xl lg:text-5xl font-bold text-cyan-400 uppercase tracking-wider mb-2">Select Your Characters
        </h1>
        <p class="text-gray-400 text-lg">Choose up to 3 characters</p>
        <div class="mt-6 flex justify-center gap-4">
          <div id="dot1" class="selection-dot"><i class="fas fa-user text-2xl text-cyan-500/30"></i></div>
          <div id="dot2" class="selection-dot"><i class="fas fa-user text-2xl text-cyan-500/30"></i></div>
          <div id="dot3" class="selection-dot"><i class="fas fa-user text-2xl text-cyan-500/30"></i></div>
        </div>
        <div class="mt-4 inline-block bg-cyan-500/10 border border-cyan-500/30 rounded-lg px-6 py-2">
          <span class="text-cyan-300 font-bold text-xl"><span id="selectedCount">0</span> / 3 Selected</span>
        </div>
      </div>
      <div class="mb-6">
        <div class="relative">
          <input type="text" id="characterSearchInput" oninput="filterCharacters()" placeholder="Search characters..."
            class="w-full bg-gray-800/80 border border-cyan-500/30 text-cyan-100 placeholder-gray-500 py-3 px-4 pl-12 rounded-xl focus:outline-none focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 transition-all">
          <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-cyan-400"></i>
        </div>
      </div>
      <div id="characterGrid" class="flex-1 overflow-y-auto pr-2">
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 lg:gap-4 character-grid">
          <div class="character-select-card bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border-2 border-cyan-500/30 overflow-hidden relative hidden"
            data-character="Shadow Warrior" data-color="cyan"
            data-image="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100&amp;h=100&amp;fit=crop"
            onclick="toggleCharacterSelection(this)">
            <div class="h-32 bg-gradient-to-br from-cyan-600/20 to-blue-600/20 flex items-center justify-center">
              <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=400&amp;h=300&amp;fit=crop" class="w-full h-full object-contain character-img">
            </div>
            <div class="p-3">
              <h3 class="text-lg font-bold text-cyan-300 uppercase tracking-wide mb-1 character-name">Shadow Warrior</h3>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-6 flex justify-center">
        <button id="continueBtn" onclick="continueToMain()"
          class="bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 text-white font-bold py-4 px-12 rounded-xl uppercase tracking-wider text-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:from-cyan-600 disabled:hover:to-blue-600 glow-border-active"
          disabled="">
          Select
        </button>
      </div>
    </div>
  </div>
  <div class="flex flex-col lg:flex-row">
    <!-- Mobile Compact Top Bar (visible on mobile only) -->
    <div
      class="lg:hidden bg-gradient-to-r from-gray-900 to-gray-950 border-b border-cyan-500/20 px-4 py-3 sticky top-0 z-50">
      <div class="flex items-center justify-between gap-3">
        <select id="tierSelectMobile" onchange="changeTier(this.value)"
          class="flex-1 bg-gray-800/80 border border-cyan-500/30 text-cyan-300 font-bold py-2 px-3 rounded-lg appearance-none cursor-pointer focus:outline-none focus:border-cyan-500 text-sm">
          <option value="1" selected>Tier 1</option>
          <option value="2">Tier 2</option>
          <option value="3">Tier 3</option>
          <option value="4">Tier 4</option>
          <option value="5">Tier 5</option>
          <option value="6">Tier 6</option>
          <option value="7">Tier 7</option>
          <option value="8">Tier 8</option>
          <option value="9">Tier 9</option>
          <option value="10">Tier 10</option>
          <option value="11">Tier 11</option>
          <option value="12">Tier 12</option>
          <option value="13">Tier 13</option>
          <option value="14">Tier 14</option>
          <option value="15">Tier 15</option>
        </select>

        <!-- <div class="bg-gray-800/50 border border-cyan-500/30 rounded-lg px-3 py-2 glow-border">
            <div class="text-cyan-400 font-bold text-sm whitespace-nowrap">
              <span class="point">0</span> / <span class="total-point">30</span>
            </div>
          </div> -->

        <button onclick="resetProgress()"
          class="bg-red-600/20 hover:bg-red-600/40 border border-red-500/50 text-red-400 font-bold px-3 py-2 rounded-lg transition-all duration-300">
          <i class="fas fa-redo-alt"></i>
        </button>
      </div>
    </div>

    <!-- Desktop Left Sidebar (hidden on mobile) -->
    <aside class="hidden lg:flex w-70 bg-gradient-to-b from-gray-900 to-gray-950 border-r border-cyan-500/20 flex-col">
      <!-- Sidebar Header -->
      <div class="p-6 border-b border-cyan-500/20">
        <h2 class="text-2xl font-bold text-cyan-400 tracking-wider uppercase">Save Data Calculator</h2>
      </div>

      <!-- Tier Selector -->
      <div class="p-6 flex-1">
        <h3 class="text-lg font-semibold text-cyan-300 mb-4 uppercase tracking-wide">Select Tier</h3>
        <div class="grid grid-cols-5 gap-2">
          <button onclick="changeTier(1)"
            class="tier-btn tier-active h-12 rounded-lg font-bold text-white flex items-center justify-center">1</button>
          <button onclick="changeTier(2)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">2</button>
          <button onclick="changeTier(3)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">3</button>
          <button onclick="changeTier(4)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">4</button>
          <button onclick="changeTier(5)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">5</button>
          <button onclick="changeTier(6)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">6</button>
          <button onclick="changeTier(7)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">7</button>
          <button onclick="changeTier(8)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">8</button>
          <button onclick="changeTier(9)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">9</button>
          <button onclick="changeTier(10)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">10</button>
          <button onclick="changeTier(11)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">11</button>
          <button onclick="changeTier(12)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">12</button>
          <button onclick="changeTier(13)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">13</button>
          <button onclick="changeTier(14)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">14</button>
          <button onclick="changeTier(15)"
            class="tier-btn h-12 bg-gray-800/50 rounded-lg font-bold text-gray-400 hover:bg-gray-700 hover:text-cyan-400 flex items-center justify-center">15</button>
        </div>
      </div>

      <!-- Reset Button -->
      <div class="p-6 border-t border-cyan-500/20">
        <button onclick="resetProgress()"
          class="w-full bg-red-600/20 hover:bg-red-600/40 border border-red-500/50 text-red-400 font-bold py-3 rounded-lg transition-all duration-300 hover:shadow-lg hover:shadow-red-500/30 uppercase tracking-wider">
          <i class="fas fa-redo-alt mr-2"></i>Reset Progress
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1" id="data-session">
      <!-- Top Navigation Bar (Desktop only) -->
      <!-- <div class="hidden lg:block bg-gradient-to-r from-gray-900 to-gray-950 border-b border-cyan-500/20 p-6 sticky top-0 z-50">
            <div class="flex items-center justify-between">
              <div>
                <h1 class="text-3xl font-bold text-cyan-400 uppercase tracking-wider">Card Collection</h1>
              </div>
              <div class="bg-gray-800/50 border border-cyan-500/30 rounded-lg px-6 py-3 glow-border">
                <div class="text-sm text-gray-400 uppercase tracking-wide">Total Points</div>
                <div class="text-3xl font-bold text-cyan-400">
                  <span class="point">0</span> / <span class="total-point">30</span>
                </div>
              </div>
            </div>
          </div> -->

      <!-- Card Grid -->
      <div class="character-section hidden">
        <div
          class="sticky-header sticky-header sticky top-0 max-lg:top-16 z-40 bg-gradient-to-r from-cyan-900/80 to-blue-900/80 backdrop-blur-md border-b border-cyan-500/30 px-4 lg:px-8 py-4 scrolled">
          <div class="flex items-center justify-between gap-4">
            <div class="flex items-center gap-3 lg:gap-4">
              <div
                class="w-12 h-12 lg:w-16 lg:h-16 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center border-2 border-cyan-400 glow-border">
                <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=100&amp;h=100&amp;fit=crop"
                  class="w-full h-full rounded-full object-cover character-img">
              </div>
              <div>
                <h2 class="text-xl lg:text-2xl font-bold text-cyan-300 uppercase tracking-wider character-name">Shadow
                  Warrior</h2>
              </div>
            </div>
            <div class="flex items-center gap-3 lg:gap-6">
              <div class="text-center">
                <div class="text-xs lg:text-sm text-gray-400 uppercase tracking-wide">Cards</div>
                <div class="text-xl lg:text-2xl font-bold text-cyan-400 card-count">8</div>
              </div>
              <div class="text-center">
                <div class="text-xs lg:text-sm text-gray-400 uppercase tracking-wide">Points</div>
                <div class="text-xl lg:text-2xl font-bold text-cyan-400"><span id="point">0</span> / <span
                    id="total-point">30</span></div>
              </div>
            </div>
          </div>
        </div>
        <div class="p-4 lg:p-8">
          <div id="cardGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6">
            <!-- Card 1 -->
            <div
              class="hidden ability-card bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl border border-cyan-500/30 overflow-hidden card-hover glow-border relative"
              data-card='basic'>
              <button onclick="deleteCard(this)" id="delete"
                class="hidden remove-btn-top absolute top-3 right-3 z-10 w-10 h-10 bg-red-600/80 hover:bg-red-600 border border-red-500 rounded-lg flex items-center justify-center text-white">
                <i class="fas fa-trash-alt"></i>
              </button>
              <div class="h-80 bg-gradient-to-br from-cyan-600/20 to-blue-600/20 flex items-center justify-center">
                <img src="" alt="Card Image" class="w-full h-full object-cover opacity-80">
              </div>
              <div class="p-5">
                <h3 class="text-xl font-bold text-cyan-300 mb-4 uppercase tracking-wide card-title">Basic Card</h3>
                <div class="space-y-2">
                  <button onclick="duplicateCard(this)" id="duplicate"
                    class="hidden action-btn action-btn-inactive w-full font-semibold py-2.5 rounded-lg transition-all duration-300 btn-glow flex items-center justify-center"
                    data-active-class="bg-cyan-600/40 hover:bg-cyan-600/40 border border-cyan-500/50 text-white-300">
                    <i class="fas fa-copy mr-2"></i>Duplicate
                  </button>
                  <button onclick="epiphanyCard(this)" data-group="ephipany" id="ephipany"
                    class="hidden action-btn action-btn-inactive w-full font-semibold py-2.5 rounded-lg transition-all duration-300 btn-glow flex items-center justify-center"
                    data-active-class="bg-purple-600/40 hover:bg-purple-600/40 border border-purple-500/50 text-white-300">
                    <i class="fas fa-lightbulb mr-2"></i>Epiphany
                  </button>
                  <button onclick="divineEpiphanyCard(this)" data-group="ephipany" id="divine-ephipany"
                    class="hidden action-btn action-btn-inactive w-full font-semibold py-2.5 rounded-lg transition-all duration-300 btn-glow flex items-center justify-center"
                    data-active-class="bg-yellow-600/40 hover:bg-yellow-600/40 border border-yellow-500/50 text-white-300">
                    <i class="fas fa-star mr-2"></i>Divine Epiphany
                  </button>
                  <button onclick="convertCard(this)" id="convert"
                    class="action-btn action-btn-inactive w-full font-semibold py-2.5 rounded-lg transition-all duration-300 btn-glow flex items-center justify-center"
                    data-active-class="bg-blue-600/40 hover:bg-blue-600/40 border border-blue-500/50 text-white-300">
                    <i class="fas fa-exchange-alt mr-2"></i>Convert
                  </button>
                  <button onclick="removeCard(this)" id="remove"
                    class="action-btn action-btn-inactive w-full font-semibold py-2.5 rounded-lg transition-all duration-300 btn-glow flex items-center justify-center"
                    data-active-class="bg-red-600/40 hover:bg-red-600/40 border border-red-500/50 text-white-300">
                    <i class="fas fa-trash-alt mr-2"></i>Remove
                  </button>
                </div>
              </div>
            </div>

            <!-- Add Card Placeholder -->
            <div onclick="openModal(this)"
              class="bg-transparent rounded-2xl border-2 border-dashed border-cyan-500/30 overflow-hidden card-hover cursor-pointer hover:border-cyan-500/60 hover:bg-cyan-500/5 transition-all duration-300 flex items-center justify-center"
              style="min-height: 450px;">
              <div class="text-center p-8">
                <div
                  class="w-20 h-20 mx-auto mb-4 rounded-full bg-cyan-500/10 border-2 border-cyan-500/30 flex items-center justify-center">
                  <i class="fas fa-plus text-4xl text-cyan-400"></i>
                </div>
                <p class="text-cyan-400 font-semibold text-lg uppercase tracking-wide">Add New Card</p>
                <p class="text-gray-500 text-sm mt-2">Click to create a new ability</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div id="cardModal" class="fixed inset-0 bg-black/80 modal-overlay hidden items-center justify-center z-50 p-4"
    onclick="closeModalOnOutside(event)">
    <div
      class="bg-gradient-to-br from-gray-900 to-gray-950 rounded-3xl border border-cyan-500/30 p-4 lg:p-6 max-w-3xl w-full modal-enter glow-border-active max-h-[90vh] flex flex-col"
      onclick="event.stopPropagation()">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl lg:text-3xl font-bold text-cyan-400 uppercase tracking-wider">Search Cards</h2>
        <button onclick="closeModal()" class="text-gray-400 hover:text-cyan-400 transition-colors">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      <div class="mb-4">
        <div class="relative">
          <input type="text" id="searchInput" oninput="filterCards()" placeholder="Search for abilities..."
            autocomplete="off"
            class="w-full bg-gray-800/80 border border-cyan-500/30 text-cyan-100 placeholder-gray-500 py-3 px-4 pl-12 rounded-xl focus:outline-none focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 transition-all">
          <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-cyan-400"></i>
        </div>
      </div>
      <div id="searchResults" class="flex-1 overflow-y-auto overflow-x-hidden space-y-2 pr-2 common-card-container">
        <div
          class="search-card-item bg-gradient-to-r from-purple-600/10 to-purple-800/10 border border-purple-500/30 rounded-xl p-4 cursor-pointer hidden common-card"
          data-type="unique" data-name="Shadow Strike" onclick="selectCardType('Shadow Strike')">
          <div class="flex items-center gap-4">
            <div class="w-16 h-16 rounded-lg bg-purple-500/20 flex items-center justify-center flex-shrink-0">
              <img src="https://img.game8.co/4316771/6daa492d8731f8c2566de0a5bca5abe1.png/show" class="common-card-img">
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-bold text-purple-300 uppercase tracking-wide common-card-title">Shadow Strike</h3>
              <div class="flex gap-2 mt-2">
                <span class="text-xs bg-purple-500/20 text-purple-300 px-2 py-1 rounded common-card-type">Unique</span>
                <span class="text-xs bg-gray-700/50 text-gray-300 px-2 py-1 rounded common-card-point">15 Points</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    cardCount = 0
    removeCount = 0
    duplicateCount = 0;
    const MAX_CHARACTERS = 3;
    combatants = []
    const commonCardPoint = {
      'neutral': 20,
      'forbidden': 20,
      'monster': 80
    }

    function openModal(btn) {
      document.getElementById('cardModal').classList.remove('hidden');
      document.getElementById('cardModal').classList.add('flex');
      document.getElementById('searchInput').value = '';
      document.getElementById('searchInput').focus();

      const section = btn.closest('.character-section')
      section.setAttribute('character-section-active', 'true')
    }

    function filterCards() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();

      const cards = document.querySelectorAll('.search-card-item');

      cards.forEach(card => {
        const name = card.getAttribute('data-name').toLowerCase();
        const type = card.getAttribute('data-type');
        const matchesSearch = name.includes(searchTerm);
        if (matchesSearch) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    }

    function closeModal() {
      document.getElementById('cardModal').classList.add('hidden');
      document.getElementById('cardModal').classList.remove('flex');

      const section = document.querySelectorAll('.character-section')
      section.forEach(section => {
        section.removeAttribute('character-section-active')
      })
    }

    function closeModalOnOutside(event) {
      if (event.target.id === 'cardModal') {
        closeModal();
      }
    }

    function selectCardType(cardName) {
      fetch("common-card-data.json")
        .then(response => response.json())
        .then(commonCards => {
          const commonCard = commonCards[cardName]
          const section = document.querySelector('[character-section-active]');
          const card = section.querySelector('.ability-card');
          const cardGrid = section.querySelector('#cardGrid');
          const addCardPlaceholder = cardGrid.querySelector('.bg-transparent');

          const clonedCard = card.cloneNode(true);
          clonedCard.classList.remove('hidden')
          cardGrid.insertBefore(clonedCard, addCardPlaceholder);

          clonedCard.setAttribute('data-card', commonCard['subtype'].split(' ')[0].toLowerCase());
          clonedCard.querySelector('#duplicate').classList.remove('hidden');
          clonedCard.querySelector('#ephipany').classList.remove('hidden');
          clonedCard.querySelector('#divine-ephipany').classList.remove('hidden');
          clonedCard.querySelector('#delete').classList.remove('hidden');

          const title = clonedCard.querySelector('.card-title');
          if (title) {
            title.innerHTML = commonCard['name'];
          }

          const imgElement = clonedCard.querySelector('[alt="Card Image"]');
          if (imgElement) {
            imgElement.setAttribute('src', commonCard['img']);
          }

          closeModal();
          changePoint(section, calculateTotalPoint(section))
        })
    }

    function changePoint(section, totalPoint) {
      const pointElement = section.querySelectorAll('#point')
      pointElement.forEach(point => {
        point.innerHTML = totalPoint
      })

      const cardCountElement = section.querySelectorAll('.card-count')
      cardCountElement.forEach(element => {
        element.innerHTML = cardCount
      })
    }

    function toggleButton(button) {
      const activeClass = button.getAttribute('data-active-class');

      if (button.classList.contains('action-btn-inactive')) {
        button.classList.remove('action-btn-inactive');
        const classes = activeClass.split(' ');
        classes.forEach(cls => button.classList.add(cls));
      } else {
        const classes = activeClass.split(' ');
        classes.forEach(cls => button.classList.remove(cls));
        button.classList.add('action-btn-inactive');
      }
    }

    function toggleEphipany(card, button) {
      const ephiGroup = card.querySelectorAll('[data-group="ephipany"]')
      const activeClass = button.getAttribute('data-active-class');

      const ephiButton = card.querySelector('button#ephipany')
      const divineEphiButton = card.querySelector('button#divine-ephipany')
      const data = card.getAttribute('data-card').split(' ')

      if (data.includes('ephipany') && button != ephiButton) {
        toggleButton(ephiButton)
        epiphanyCard(ephiButton, true)
      }

      if (data.includes('divine-ephipany') && button != divineEphiButton) {
        toggleButton(divineEphiButton)
        divineEpiphanyCard(divineEphiButton, true)
      }

      toggleButton(button)
    }

    function epiphanyCard(button, skipToggle = false) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');

      if (!card.getAttribute('data-card').split(' ').includes('basic') || card.getAttribute('data-card').split(' ').includes('convert')) {
        if (!skipToggle) {
          toggleEphipany(card, button)
        }

        data = card.getAttribute('data-card').split(' ')

        if (!data.includes('ephipany')) {
          card.setAttribute('data-card', `${data.join(' ')} ephipany`)

          if (data.includes('neutral')) {
          }
        } else {
          card.setAttribute('data-card', data.filter(item => item !== 'ephipany').join(' '))

          if (data.includes('neutral')) {
          }
        }
      }

      changePoint(section, calculateTotalPoint(section))
    }

    function divineEpiphanyCard(button, skipToggle = false) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');

      if (!card.getAttribute('data-card').split(' ').includes('basic') || card.getAttribute('data-card').split(' ').includes('convert')) {
        if (!skipToggle) {
          toggleEphipany(card, button)
        }

        data = card.getAttribute('data-card').split(' ')

        if (!data.includes('divine-ephipany')) {
          card.setAttribute('data-card', `${data.join(' ')} divine-ephipany`)
        } else {
          card.setAttribute('data-card', data.filter(item => item !== 'divine-ephipany').join(' '))
        }
      }

      changePoint(section, calculateTotalPoint(section))
    }

    function convertCard(button) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');

      toggleButton(button)
      data = card.getAttribute('data-card').split(' ')

      if (!data.includes('convert')) {
        const duplicateButton = card.querySelector('#duplicate').classList.remove('hidden');
        const ephipanyButton = card.querySelector('#ephipany').classList.remove('hidden')
        const divineEphipanyButton = card.querySelector('#divine-ephipany').classList.remove('hidden')

        card.setAttribute('data-card', `${data.join(' ')} convert`)
      } else {
        if (data.includes('basic')) {
          const duplicateButton = card.querySelector('#duplicate');
          const ephipanyButton = card.querySelector('#ephipany');
          const divineEphipanyButton = card.querySelector('#divine-ephipany');

          duplicateButton.classList.add('hidden')
          ephipanyButton.classList.add('hidden')
          divineEphipanyButton.classList.add('hidden')

          if (data.includes('duplicate')) {
            toggleButton(duplicateButton)
          }

          if (data.includes('ephipany')) {
            toggleButton(ephipanyButton)
          }

          if (data.includes('divine-ephipany')) {
            toggleButton(divineEphipanyButton)
          }

          data = data.filter(item => !['duplicate', 'ephipany', 'divine-ephipany'].includes(item))
        }

        card.setAttribute('data-card', data.filter(item => item !== 'convert').join(' '))
      }

      changePoint(section, calculateTotalPoint(section))
    }

    function removeCard(button) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');

      toggleButton(button)
      data = card.getAttribute('data-card').split(' ')

      if (!data.includes('remove')) {
        card.setAttribute('data-card', `${data.join(' ')} remove`)
      } else {
        card.setAttribute('data-card', data.filter(item => item !== 'remove').join(' '))
      }

      changePoint(section, calculateTotalPoint(section))
    }

    function duplicateCard(button) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');
      const cardGrid = section.querySelector('#cardGrid');
      const addCardPlaceholder = cardGrid.querySelector('.bg-transparent');

      card.getAttribute('data-card').split(' ')

      if (!card.getAttribute('data-card').split(' ').includes('basic')) {
        const clonedCard = card.cloneNode(true);
        clonedCard.classList.add('card-duplicate-animation');

        const duplicateBtn = clonedCard.querySelector('button[onclick*="duplicateCard"]');
        const activeClass = duplicateBtn.getAttribute('data-active-class');
        duplicateBtn.classList.remove('action-btn-inactive');
        const classes = activeClass.split(' ');
        classes.forEach(cls => duplicateBtn.classList.add(cls));

        const deleteBtn = clonedCard.querySelector('#delete');
        deleteBtn.classList.remove('hidden')

        const dataCard = clonedCard.getAttribute('data-card').split(' ')
        if (!dataCard.includes('duplicate')) {
          clonedCard.setAttribute('data-card', `${dataCard.join(' ')} duplicate`)
        }

        cardGrid.insertBefore(clonedCard, card.nextSibling);

        const title = clonedCard.querySelector('.card-title');
        if (title) {
          title.innerHTML = title.innerHTML.includes('Replicated') ? title.innerHTML : title.innerHTML + " / Replicated"
        }
      }

      changePoint(section, calculateTotalPoint(section))

      if (!button.classList.contains('action-btn-inactive')) {
        return;
      }
    }

    function getRemovePoint() {
      const values = [0, 10, 30, 50, 70];
      return values[Math.min(removeCount - 1, values.length - 1)];
    }

    function getDuplicatePoint() {
      const values = [0, 10, 30, 50, 70];
      return values[Math.min(duplicateCount - 1, values.length - 1)];
    }

    function calculateCardPoint(card) {
      point = 0

      convertedPoint = 10
      basicCardRemovePoint = 20
      ephipanyPoint = 10
      divineEphipanyPoint = 20
      // const commonCardPoint = {
      //   'neutral': 20,
      //   'forbidden': 20,
      //   'monster': 80
      // }

      data = card.getAttribute('data-card').split(' ')

      point += (commonCardPoint[data[0]] || 0)

      if (data.includes('convert')) {
        point += convertedPoint
      }

      if (data.includes('duplicate')) {
        duplicateCount += 1
        point += getDuplicatePoint()
      }

      if (data.includes('remove')) {
        cardCount -= 1
        removeCount += 1

        if (!data.includes('convert')) {
          point += getRemovePoint()
        }

        if ((data.includes('basic') || data.includes('unique')) && !data.includes('convert')) {
          point += basicCardRemovePoint
        }
      }

      // if (data.includes('remove')) {
      //   return point
      // }

      if (data.includes('ephipany') && ['convert', 'neutral', 'monster'].some(item => data.includes(item))) {
        point += ephipanyPoint
      }

      if (data.includes('divine-ephipany')) {
        point += divineEphipanyPoint
      }

      return point
    }

    function calculateTotalPoint(section) {
      cardCount = -1
      totalPoint = 0
      removeCount = 0
      duplicateCount = 0

      const cards = section.querySelectorAll('.ability-card')

      cards.forEach(card => {
        cardCount += 1
        totalPoint += calculateCardPoint(card)
      })

      return totalPoint
    }

    function setupCharaCard(session) {
      const sessionGrid = document.getElementById('data-session');

      fetch("chara.json")
        .then(response => response.json())
        .then(data => {
          combatants.forEach(combatant => {
            i = 0

            combatantData = data[combatant]
            combatantCards = combatantData['cards']

            const sessionCloned = session.cloneNode(true);
            sessionCloned.classList.remove('hidden')
            sessionGrid.insertBefore(sessionCloned, sessionGrid.lastElementChild);

            const characterName = sessionCloned.querySelector('.character-name');
            const characterImg = sessionCloned.querySelector('.character-img');

            characterName.innerHTML = combatantData['name']
            characterImg.setAttribute('src', combatantData['img'])

            const card = sessionCloned.querySelector('.ability-card');
            const cardGrid = sessionCloned.querySelector('#cardGrid');
            const addCardPlaceholder = cardGrid.querySelector('.bg-transparent');

            combatantCards.forEach(combatantCard => {
              const clonedCard = card.cloneNode(true);
              clonedCard.classList.remove('hidden')

              cardGrid.insertBefore(clonedCard, addCardPlaceholder);
              const duplicateButton = clonedCard.querySelector('#duplicate');
              const ephipanyButton = clonedCard.querySelector('#ephipany');
              const divineEphipanyButton = clonedCard.querySelector('#divine-ephipany');

              if (i > 2) {
                clonedCard.setAttribute('data-card', 'unique');
                duplicateButton.classList.remove('hidden')
                ephipanyButton.classList.remove('hidden')
                divineEphipanyButton.classList.remove('hidden')
              }

              if (i > 3) {
                clonedCard.querySelector('#delete').classList.remove('hidden');
              }

              const title = clonedCard.querySelector('.card-title');
              if (title) {
                title.innerHTML = combatantCard['title']
              }

              const imgElement = clonedCard.querySelector('[alt="Card Image"]');
              if (imgElement) {
                imgElement.setAttribute('src', combatantCard['img_url']);
              }

              i += 1
            })
          })
        });
    }

    function setupCommonCard(session) {
      fetch("common-card-data.json")
        .then(response => response.json())
        .then(commonCards => {
          const commonCardContainer = document.querySelector('.common-card-container');
          const commonCard = commonCardContainer.querySelector('.common-card');

          Object.entries(commonCards).forEach(([key, card]) => {
            const commonCardClone = commonCard.cloneNode(true);
            commonCardClone.classList.remove('hidden')
            commonCardContainer.insertBefore(commonCardClone, commonCardContainer.lastElementChild);

            const commonCardImg = commonCardClone.querySelector('.common-card-img');
            const commonCardTitle = commonCardClone.querySelector('.common-card-title');
            const commonCardType = commonCardClone.querySelector('.common-card-type');
            const commonCardPointElement = commonCardClone.querySelector('.common-card-point');

            commonCardClone.setAttribute('data-name', card['name'])
            commonCardClone.setAttribute('data-type', card['subtype'])
            commonCardClone.setAttribute('onclick', `selectCardType('${card['name']}')`)

            commonCardImg.setAttribute('src', card['img']);
            commonCardTitle.innerHTML = card['name'];
            commonCardType.innerHTML = card['subtype'];
            commonCardPointElement.innerHTML = commonCardPoint[card['subtype'].split(' ')[0].toLowerCase()];
          })
        })
    }

    function setupCharacter() {
      fetch("chara.json")
        .then(response => response.json())
        .then(characters => {
          characterGrid = document.querySelector('.character-grid'); 
          characterCard = characterGrid.querySelector('.character-select-card');

          Object.entries(characters).forEach(([key, character]) => {
            if (character['cards']) {
              const characterClone = characterCard.cloneNode(true);
              characterClone.classList.remove('hidden')
              characterGrid.insertBefore(characterClone, characterGrid.lastElementChild);

              const characterName = characterClone.querySelector('.character-name');
              const characterImg = characterClone.querySelector('.character-img');

              characterClone.setAttribute('data-name', character['name'])
              characterClone.setAttribute('data-img', character['img'])

              characterName.innerHTML = character['name']
              characterImg.setAttribute('src', character['img'])  
            }
          })
        })
    }

    function onLoad() {
      const session = document.querySelector('.character-section');
      setupCharaCard(session)
      setupCommonCard(session)
    }

    setupCharacter()

    function deleteCard(button) {
      const card = button.closest('.ability-card');
      const section = card.closest('.character-section');
      const cardGrid = document.getElementById('cardGrid');
      const abilityCards = cardGrid.querySelectorAll('.ability-card');

      card.style.transition = 'all 0.3s ease-out';
      card.style.opacity = '0';
      card.style.transform = 'scale(0.8)';

      card.remove();
      changePoint(section, calculateTotalPoint(section))
    }

    function changeTier(tier) {
      const desktopButtons = document.querySelectorAll('.tier-btn');
      desktopButtons.forEach(btn => {
        btn.classList.remove('tier-active');
        btn.classList.add('bg-gray-800/50', 'text-gray-400');
      });

      const activeButton = Array.from(desktopButtons).find(btn => btn.textContent === tier.toString());
      if (activeButton) {
        activeButton.classList.add('tier-active');
        activeButton.classList.remove('bg-gray-800/50', 'text-gray-400');
      }

      const mobileSelect = document.getElementById('tierSelectMobile');
      if (mobileSelect) {
        mobileSelect.value = tier;
      }

      const totalPointElement = document.querySelectorAll('#total-point')
      totalPointElement.forEach(point => {
        point.innerHTML = 20 + (tier * 10)
      })

      console.log('Changed to tier:', tier);
    }

    function resetProgress() {
      if (confirm('Are you sure you want to reset all progress? This action cannot be undone.')) {
        const charaSessions = document.querySelectorAll('.character-section:not(.hidden)');

        charaSessions.forEach(session => {
          session.remove()
        })

        onLoad()
      }
    }

    window.addEventListener('scroll', function () {
      const headers = document.querySelectorAll('.sticky-header');
      headers.forEach(header => {
        if (window.scrollY > 50) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
      });
    });

    function updateSelectionDots(card) {
      const characterName = card.getAttribute('data-name');
      const characterImg = card.getAttribute('data-img')

      const filledDotsByChara = document.querySelector(`.filled img[alt="${characterName}"]`);

      if (!filledDotsByChara) {
        const dotElement = document.querySelector('.selection-dot:not(.filled)');

        dotElement.innerHTML = `<img src="${characterImg}" alt="${characterName}" class="dot-fill-animation">`;
        dotElement.classList.add('filled'); 
        return
      }
      
      const dotElement = filledDotsByChara.closest('.filled')
      dotElement.classList.remove('filled')
      dotElement.innerHTML = '<i class="fas fa-user text-2xl text-cyan-500/30"></i>'
    }

    function filterCharacters() {
      const searchTerm = document.getElementById('characterSearchInput').value.toLowerCase();
      const cards = document.querySelectorAll('.character-select-card');
      cards.forEach(card => {
        const name = card.getAttribute('data-name').toLowerCase();
        if (name.includes(searchTerm)) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none';
        }
      });
    }

    function toggleCharacterSelection(card) {
      const characterName = card.getAttribute('data-name');
      const isSelected = card.classList.contains('character-selected');

      if (isSelected) {
        card.classList.remove('character-selected');
        combatants = combatants.filter(c => c !== characterName);
      } else {
        if (combatants.length >= MAX_CHARACTERS) {
          alert(`You can only select up to ${MAX_CHARACTERS} characters!`);
          return;
        }
        card.classList.add('character-selected');
        combatants.push(characterName);
      }

      document.getElementById('selectedCount').textContent = combatants.length;
      document.getElementById('continueBtn').disabled = combatants.length === 0;
      updateSelectionDots(card);
    }

    function continueToMain() {
      if (combatants.length === 0) return;

      document.getElementById('characterSelectionModal').style.display = 'none';
      onLoad()
    }
  </script>

</body>

</html>